import e,{useState as t}from"react";import{View as n}from"react-native";import{WebView as a}from"react-native-webview";class i{webView;onSendAction;constructor(e,t){this.webView=e,this.onSendAction=t}sendAction(e){this.onSendAction(e);const t=JSON.stringify(e);this.webView?.injectJavaScript(`\n      window.postMessage(${t}, '*')\n      true\n    `)}getState(){this.sendAction({action:"getstate",payload:null})}sendChatMessage(e){this.sendAction({action:"chat_sendmessage",payload:{message:e}})}setChatUsername(e){this.sendAction({action:"chat_setusername",payload:{username:e}})}vote(e){this.sendAction({action:"vote",payload:{answerId:e}})}}function s(e){const[t,n]=e.split(":");return parseInt(t)/parseInt(n)}function o({channelId:o,uri:d,onActionsReady:p,onEvent:l,onSendAction:w=(()=>{}),style:h={},autoUpdateAspectRatio:m=!0,viewProps:v={},webViewProps:g={}}){const u=d||o&&c({channelId:o});if(!u)throw new Error(`Either 'channelId' or 'uri' was missing: channelId='${o}', uri='${d}'`);const[y,A]=t(),f={aspectRatio:y,width:"100%",...h};return e.createElement(n,{...v,style:f},e.createElement(a,{...g,ref:e=>{p(new i(e,w))},source:{uri:u},onMessage:e=>(e=>{var t;(t=e).name&&"payload"in t&&(!m||"stageten_init"!==e.name&&"aspect_ratio_change"!==e.name||A(s(e?.payload.aspectRatio)),l(e))})(JSON.parse(e.nativeEvent.data)),mediaPlaybackRequiresUserAction:!1,allowsInlineMediaPlayback:!0,injectedJavaScriptBeforeContentLoaded:`\n          window.addEventListener('message', (event) => {\n            if (event.origin !== '${r}') {\n              return\n            }\n            window.ReactNativeWebView.postMessage(JSON.stringify(event.data))\n          })\n        `}))}const r="https://sandbox-player.stageten.tv",c=({origin:e=r,channelId:t})=>`${e}/sdk/${t}`;export{o as StageTenPlayer,s as parseAspectRatio};
